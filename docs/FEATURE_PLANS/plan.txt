 ğŸ¯ Dashboard Upgrade Plan - Refined

  Executive Summary

  Transform the placeholder dashboard into a real-time operations center showing:
  - Daily sales & revenue (what you're making today)
  - Order fulfillment (what needs to go out the door)
  - Customer insights (who's buying and when)
  - Product performance (what's selling)

  ---
  ğŸ“Š Phase 1: Data Discovery & Metrics Definition

  Available Data Sources (from your existing DB):

  Based on your Prisma schema and routes:

  Orders Data:
  - Order table: status, total, delivery date, customer info
  - OrderItem: products, quantities, prices
  - OrderStatus: DRAFT, CONFIRMED, PREPARING, OUT_FOR_DELIVERY, DELIVERED, CANCELLED

  Payment Data:
  - PaymentTransaction: amount (cents), type, status, timestamp
  - Payment types: CASH, CARD, GIFT_CARD, FTD, etc.

  Customer Data:
  - Customer: total customers, new signups, repeat buyers
  - CustomerRecipient: relationship tracking

  Product Data:
  - Product: inventory, pricing
  - AddOnGroup & AddOn: add-on sales

  ---
  ğŸ¨ Proposed Dashboard Layout

  Row 1: Key Metrics (4 Cards)

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Today's    â”‚   Orders    â”‚  Deliveries â”‚   New       â”‚
  â”‚  Revenue    â”‚   Pending   â”‚   Today     â”‚   Customers â”‚
  â”‚             â”‚             â”‚             â”‚             â”‚
  â”‚  $1,247.50  â”‚     23      â”‚     18      â”‚      5      â”‚
  â”‚  â†‘ +15%     â”‚   ğŸ”´ 3 late â”‚  âœ… On time â”‚  This week  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Row 2: Revenue Trends (2 Charts)

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  7-Day Revenue Trend         â”‚  Payment Mix Today       â”‚
  â”‚  (Line Chart)                â”‚  (Donut Chart)           â”‚
  â”‚                              â”‚                          â”‚
  â”‚  Shows daily gross revenue   â”‚  Cash: 40%               â”‚
  â”‚  with comparison to last     â”‚  Card: 45%               â”‚
  â”‚  week                        â”‚  Gift Card: 15%          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Row 3: Operations & Products

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Top 5 Products This Week    â”‚  Order Status Breakdown  â”‚
  â”‚  (Bar Chart)                 â”‚  (Stacked Bar)           â”‚
  â”‚                              â”‚                          â”‚
  â”‚  1. Red Roses Bouquet: 45    â”‚  Preparing: 12           â”‚
  â”‚  2. Mixed Arrangement: 32    â”‚  Out for Delivery: 8     â”‚
  â”‚  3. Orchid Plant: 28         â”‚  Delivered: 156          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Row 4: Alerts & Quick Actions

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  âš ï¸ Alerts                                                â”‚
  â”‚  â€¢ 3 orders scheduled for today not yet OUT_FOR_DELIVERY â”‚
  â”‚  â€¢ 2 draft orders from yesterday need attention          â”‚
  â”‚  â€¢ 5 customers waiting for delivery confirmation         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  ğŸ”§ Detailed Metrics Specification

  1. Today's Revenue Card

  Data Source:
  // Query payment transactions for today
  SELECT SUM(amount) FROM PaymentTransaction
  WHERE createdAt >= today
  AND status = 'COMPLETED'

  Display:
  - Main number: Total revenue (cents â†’ dollars)
  - Comparison: vs. yesterday or same day last week
  - Trend indicator: â†‘ green if higher, â†“ red if lower

  SQL Equivalent:
  -- Today
  SELECT SUM(amount) / 100 as revenue_dollars
  FROM "PaymentTransaction"
  WHERE DATE(created_at) = CURRENT_DATE
  AND status = 'COMPLETED'

  -- Yesterday for comparison
  SELECT SUM(amount) / 100 as revenue_dollars
  FROM "PaymentTransaction"
  WHERE DATE(created_at) = CURRENT_DATE - 1
  AND status = 'COMPLETED'

  ---
  2. Orders Pending Card

  Data Source:
  // Count orders in active states
  SELECT COUNT(*) FROM Order
  WHERE status IN ('CONFIRMED', 'PREPARING')
  AND delivery_date <= today + 3 days

  Display:
  - Main number: Count of pending orders
  - Alert: Highlight if delivery date < today (overdue)
  - Breakdown: "3 for today, 8 for tomorrow"

  ---
  3. Deliveries Today Card

  Data Source:
  // Orders scheduled for delivery today
  SELECT COUNT(*), status FROM Order
  WHERE DATE(delivery_date) = today
  GROUP BY status

  Display:
  - Main number: Total deliveries scheduled
  - Status breakdown:
    - âœ… Delivered: 12
    - ğŸšš Out for delivery: 4
    - âš ï¸ Not started: 2

  ---
  4. New Customers Card

  Data Source:
  // Customers created this week
  SELECT COUNT(*) FROM Customer
  WHERE created_at >= start_of_week

  Display:
  - Main number: New signups this week
  - Trend: Weekly growth percentage

  ---
  ğŸ“ˆ Chart Library Recommendation

  Use Recharts (already lightweight, React-friendly):

  npm install recharts

  Why Recharts:
  - âœ… Built for React
  - âœ… Responsive by default
  - âœ… Dark mode support
  - âœ… Small bundle size
  - âœ… TypeScript support

  Example Line Chart:
  import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip } from 'recharts';

  const data = [
    { day: 'Mon', revenue: 1250 },
    { day: 'Tue', revenue: 980 },
    { day: 'Wed', revenue: 1450 },
    // ...
  ];

  <LineChart data={data}>
    <XAxis dataKey="day" />
    <YAxis />
    <CartesianGrid strokeDasharray="3 3" />
    <Line type="monotone" dataKey="revenue" stroke="#597485" />
    <Tooltip />
  </LineChart>

  ---
  ğŸ—ï¸ Implementation Plan

  Phase 1: Backend - Dashboard Aggregation API (4-6 hours)

  File: /back/src/routes/dashboard.ts

  Endpoints to create:

  // GET /api/dashboard/metrics
  // Returns all KPI numbers for top row cards
  {
    todayRevenue: { amount: 124750, percentChange: 15 },
    ordersPending: { count: 23, overdue: 3 },
    deliveriesToday: { total: 18, byStatus: {...} },
    newCustomers: { week: 5, month: 23 }
  }

  // GET /api/dashboard/revenue-trend?days=7
  // Returns daily revenue for chart
  [
    { date: '2025-01-27', revenue: 125000 },
    { date: '2025-01-28', revenue: 98000 },
    // ...
  ]

  // GET /api/dashboard/top-products?days=7
  // Returns best-selling products
  [
    { productId: 'xxx', name: 'Red Roses', quantity: 45, revenue: 225000 },
    // ...
  ]

  // GET /api/dashboard/alerts
  // Returns actionable alerts
  [
    { type: 'late_delivery', count: 3, message: '...' },
    // ...
  ]

  Implementation Pattern:
  router.get('/metrics', async (req, res) => {
    const today = new Date();
    today.setHours(0, 0, 0, 0);

    const [todayRevenue, yesterdayRevenue, pendingOrders] = await Promise.all([
      prisma.paymentTransaction.aggregate({
        where: {
          createdAt: { gte: today },
          status: 'COMPLETED'
        },
        _sum: { amount: true }
      }),
      // ... more queries
    ]);

    res.json({
      todayRevenue: {
        amount: todayRevenue._sum.amount || 0,
        percentChange: calculateChange(todayRevenue, yesterdayRevenue)
      },
      // ...
    });
  });

  ---
  Phase 2: Frontend - Custom Hooks (3-4 hours)

  File: /admin/src/shared/hooks/useDashboard.ts

  export function useDashboardMetrics() {
    const apiClient = useApiClient();
    const [metrics, setMetrics] = useState(null);
    const [loading, setLoading] = useState(true);

    useEffect(() => {
      const fetchMetrics = async () => {
        const data = await apiClient.get('/api/dashboard/metrics');
        setMetrics(data.data);
        setLoading(false);
      };
      fetchMetrics();

      // Refresh every 5 minutes
      const interval = setInterval(fetchMetrics, 5 * 60 * 1000);
      return () => clearInterval(interval);
    }, []);

    return { metrics, loading };
  }

  ---
  Phase 3: Frontend - Dashboard UI (6-8 hours)

  File: /admin/src/app/pages/Dashboard/Home.tsx

  Replace placeholder widgets with:

  1. Metric Cards Component:
  <div className="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4">
    <MetricCard
      title="Today's Revenue"
      value={formatCurrency(metrics.todayRevenue.amount)}
      change={metrics.todayRevenue.percentChange}
      trend={metrics.todayRevenue.percentChange > 0 ? 'up' : 'down'}
    />
    {/* More cards */}
  </div>

  2. Chart Components:
  <RevenueTrendChart data={revenueTrend} />
  <TopProductsChart data={topProducts} />
  <OrderStatusChart data={orderStatus} />

  3. Alerts Component:
  <AlertsPanel alerts={alerts} />

  ---
  Phase 4: Polish & Optimization (2-3 hours)

  - âœ… Add loading skeletons
  - âœ… Error handling & retry logic
  - âœ… Dark mode for all charts
  - âœ… Responsive breakpoints
  - âœ… Date range filters (Today / Week / Month toggle)
  - âœ… Click-through links (e.g., "23 pending" â†’ Orders page filtered)

  ---
  ğŸ“Š Proposed Metrics Priority (MVP)

  Must-Have (Week 1):

  1. âœ… Today's Revenue
  2. âœ… Orders Pending
  3. âœ… Deliveries Today
  4. âœ… 7-Day Revenue Trend Chart

  Nice-to-Have (Week 2):

  5. âœ… New Customers
  6. âœ… Top Products Chart
  7. âœ… Payment Mix Chart
  8. âœ… Alerts Panel

  Future Enhancements:

  9. ğŸ“… Calendar view of deliveries
  10. ğŸ’° Profit margins (if cost data available)
  11. ğŸ“ Delivery route map
  12. ğŸ“ Customer contact stats
  13. ğŸ Gift card usage trends

  ---
  â±ï¸ Time Estimates

  | Phase | Task                   | Hours       |
  |-------|------------------------|-------------|
  | 1     | Backend API endpoints  | 4-6         |
  | 2     | Frontend hooks & state | 3-4         |
  | 3     | UI components & charts | 6-8         |
  | 4     | Polish & testing       | 2-3         |
  | Total | MVP Dashboard          | 15-21 hours |

  ---
  ğŸ¯ Success Criteria

  Dashboard is complete when:
  - âœ… Shows real data, not placeholders
  - âœ… Updates automatically (5-minute refresh)
  - âœ… All numbers match manual queries
  - âœ… Centsâ†’dollars conversion is correct
  - âœ… Works in dark mode
  - âœ… Responsive on mobile/tablet
  - âœ… Loading states don't flicker
  - âœ… Clicking metrics navigates to detail pages

  ---
  ğŸš€ Next Steps

  1. Review & Approve this plan
  2. Choose MVP scope (which metrics to build first)
  3. Wireframe approval (I can create mockups)
  4. Implementation (I'll build it step-by-step with you)

  Should I proceed with building the MVP dashboard? I recommend starting with the 4 metric cards + revenue trend chart (Phase 1 + part of
  Phase 3) as a proof-of-concept.